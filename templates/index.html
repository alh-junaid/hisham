{% extends 'layout.html' %}
{% block content %}
  <div class="add-form">
    <form action="/add" method="post">
      <input type="text" name="description" placeholder="Description" required>
      <input type="number" step="0.01" name="amount" placeholder="Amount" required>
      <input type="date" name="date" value="{{ (now() if false) }}" required>
      <input type="text" name="category" placeholder="Category" required>
      <button type="submit">Add</button>
    </form>
  </div>

  <div class="filters">
    <form method="get" action="/">
      <select name="category">
        <option value="">All categories</option>
        {% for c in categories %}
          <option value="{{c}}">{{c}}</option>
        {% endfor %}
      </select>
      <button type="submit">Filter</button>
    </form>
  </div>

  <table class="expenses">
    <thead>
      <tr><th>Date</th><th>Description</th><th>Category</th><th>Amount</th><th>Actions</th></tr>
    </thead>
    <tbody>
      {% for e in expenses %}
      <tr>
        <td>{{ e.date.strftime('%Y-%m-%d') if e.date }}</td>
        <td>{{ e.description }}</td>
        <td>{{ e.category }}</td>
        <td>{{ '%.2f'|format(e.amount) }}</td>
        <td>
          <a href="/edit/{{ e._id }}">Edit</a>
          <form action="/delete/{{ e._id }}" method="post" style="display:inline">
            <button type="submit" onclick="return confirm('Delete?')">Delete</button>
          </form>
        </td>
      </tr>
      {% else %}
      <tr><td colspan="5">No expenses yet.</td></tr>
      {% endfor %}
    </tbody>
  </table>
{% endblock %}
